#!/bin/bash
if [ -z "$GEMINI_API_KEY" ]; then
    echo "!!! VIRHE: GEMINI_API_KEY puuttuu."
    exit 1
fi

# Asetetaan Gemini 2.5 Flash
MODEL="gemini-2.5-flash"
API_URL="https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=$GEMINI_API_KEY"

RESPONSE=$(curl -s -X POST "$API_URL" \
    -H 'Content-Type: application/json' \
    -d "{\"contents\": [{\"parts\":[{\"text\":\"$*\"}]}]}")

TEXT=$(echo "$RESPONSE" | jq -r '.candidates[0].content.parts[0].text' 2>/dev/null)

if [ "$TEXT" != "null" ] && [ ! -z "$TEXT" ]; then
    echo "$TEXT"
else
    echo "--- GEMINI 2.5 DEBUG ---"
    echo "RAAKA VASTAUS:"
    echo "$RESPONSE" | jq . 2>/dev/null || echo "$RESPONSE"
fi
